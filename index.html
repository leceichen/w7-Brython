<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>Brython Ê©üÂô®‰∫∫Ë°åËµ∞Ê®°Êì¨</title>

  <!-- ‚úÖ Ê≠£Á¢∫ËºâÂÖ• Brython  -->
  <script src="https://cdn.jsdelivr.net/npm/brython@3.10.12/brython.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/brython@3.10.12/brython_stdlib.js"></script>

  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    canvas {
      border: 1px solid #333;
      background: #f0f0f0;
      margin-top: 10px;
    }
    #controls {
      margin-top: 10px;
    }
    button {
      margin: 0 5px;
      padding: 5px 10px;
    }
  </style>
</head>

<body onload="brython()">
  <h1>ü§ñ Brython Ê©üÂô®‰∫∫Ë°åËµ∞Ê®°Êì¨</h1>
  <div id="controls">
    <button id="forward">ÂâçÈÄ≤</button>
    <button id="backward">ÂæåÈÄÄ</button>
    <button id="left">Â∑¶ËΩâ</button>
    <button id="right">Âè≥ËΩâ</button>
    <button id="reset">ÈáçË®≠</button>
  </div>
  <canvas id="world" width="400" height="400"></canvas>

  <!-- ‚úÖ ÈÄôÊÆµÊâçÊòØ Python Á®ãÂºè -->
  <script type="text/python">
from browser import document, html, timer

canvas = document["world"]
ctx = canvas.getContext("2d")

cell_size = 40
robot = {"x": 5, "y": 5, "dir": 0}  # dir: 0=‰∏ä, 1=Âè≥, 2=‰∏ã, 3=Â∑¶

def draw_grid():
    ctx.clearRect(0, 0, canvas.width, canvas.height)
    ctx.strokeStyle = "#ccc"
    for i in range(0, canvas.width, cell_size):
        ctx.beginPath()
        ctx.moveTo(i, 0)
        ctx.lineTo(i, canvas.height)
        ctx.stroke()
    for j in range(0, canvas.height, cell_size):
        ctx.beginPath()
        ctx.moveTo(0, j)
        ctx.lineTo(canvas.width, j)
        ctx.stroke()

def draw_robot():
    x = robot["x"] * cell_size + cell_size/2
    y = robot["y"] * cell_size + cell_size/2
    ctx.fillStyle = "red"
    ctx.beginPath()
    ctx.arc(x, y, cell_size/3, 0, 2*3.14159)
    ctx.fill()
    # ÊñπÂêëÁÆ≠È†≠
    ctx.strokeStyle = "black"
    ctx.beginPath()
    if robot["dir"] == 0:
        ctx.moveTo(x, y)
        ctx.lineTo(x, y - cell_size/2)
    elif robot["dir"] == 1:
        ctx.moveTo(x, y)
        ctx.lineTo(x + cell_size/2, y)
    elif robot["dir"] == 2:
        ctx.moveTo(x, y)
        ctx.lineTo(x, y + cell_size/2)
    else:
        ctx.moveTo(x, y)
        ctx.lineTo(x - cell_size/2, y)
    ctx.stroke()

def render(ev=None):
    draw_grid()
    draw_robot()

def forward(ev):
    if robot["dir"] == 0:
        robot["y"] -= 1
    elif robot["dir"] == 1:
        robot["x"] += 1
    elif robot["dir"] == 2:
        robot["y"] += 1
    else:
        robot["x"] -= 1
    render()

def backward(ev):
    if robot["dir"] == 0:
        robot["y"] += 1
    elif robot["dir"] == 1:
        robot["x"] -= 1
    elif robot["dir"] == 2:
        robot["y"] -= 1
    else:
        robot["x"] += 1
    render()

def turn_left(ev):
    robot["dir"] = (robot["dir"] - 1) % 4
    render()

def turn_right(ev):
    robot["dir"] = (robot["dir"] + 1) % 4
    render()

def reset(ev):
    robot["x"], robot["y"], robot["dir"] = 5, 5, 0
    render()

document["forward"].bind("click", forward)
document["backward"].bind("click", backward)
document["left"].bind("click", turn_left)
document["right"].bind("click", turn_right)
document["reset"].bind("click", reset)

render()
  </script>
</body>
</html>

